"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1491],{1491:function(e,s,a){a.r(s);var t=a(567),r=a(4932),i=a(5893),l=a(7294),o=a(1664),n=a.n(o),c=a(1163),d=a(8736),m=a(585),u=a(3890),x=a(382),h=a(7383),p=a(1562),g=a(2088),y=a(3104),f=a(1382),b=a(826),j=a(2390),v=a(559),N=a(9744),w=a(1450),Z=a(6501),k=a(3495),C=a(1526);s.default=()=>{let[e,s]=(0,l.useState)("login"),[a,o]=(0,l.useState)({email:"",password:"",role:"candidate"}),[P,S]=(0,l.useState)(!1),[E,M]=(0,l.useState)(!1),[_,F]=(0,l.useState)({otpMethod:"sms",otp:"",biometricEnabled:!1,securityQuestions:[]}),[A,L]=(0,l.useState)(0),[B,I]=(0,l.useState)(!1),[V,q]=(0,l.useState)(!1),[G,T]=(0,l.useState)("email"),{login:D,resetPassword:R,signInWithGoogle:U}=(0,d.a)(),O=(0,c.useRouter)();(0,l.useEffect)(()=>{let e;return A>0&&(e=setInterval(()=>{L(e=>e<=1?(I(!0),0):e-1)},1e3)),()=>clearInterval(e)},[A]);let Q=e=>{o((0,r._)((0,t._)({},a),{[e.target.name]:e.target.value}))},W=async e=>{e.preventDefault(),M(!0);try{let e=await D(a.email,a.password,a.role);(null==e?void 0:e.requiresMFA)?(s("mfa"),await z(),Z.ZP.success("Login successful! Please complete verification.")):(Z.ZP.success("Login successful!"),K())}catch(e){console.error("Login error:",e),Z.ZP.error(e.message||"Login failed. Please try again.")}finally{M(!1)}},z=async()=>{try{M(!0),await new Promise(e=>setTimeout(e,1e3)),L(60),I(!1),Z.ZP.success("Verification code sent via ".concat(_.otpMethod))}catch(e){Z.ZP.error("Failed to send verification code")}finally{M(!1)}},H=async()=>{if(!_.otp||6!==_.otp.length){Z.ZP.error("Please enter a valid 6-digit code");return}try{M(!0),await new Promise(e=>setTimeout(e,1e3)),Z.ZP.success("Verification successful!"),K()}catch(e){Z.ZP.error("Invalid verification code")}finally{M(!1)}},J=async()=>{try{M(!0),await new Promise(e=>setTimeout(e,2e3)),Z.ZP.success("Biometric authentication successful!"),K()}catch(e){Z.ZP.error("Biometric authentication failed")}finally{M(!1)}},K=()=>{let e="candidate"===a.role?"/candidate/dashboard":"company"===a.role?"/company/dashboard":"/admin/dashboard";O.push(e)},X=async()=>{try{M(!0),await U(),Z.ZP.success("Google login successful!"),K()}catch(e){Z.ZP.error("Google login failed")}finally{M(!1)}},Y=async()=>{if(!a.email){Z.ZP.error("Please enter your email address");return}try{M(!0),await R(a.email),q(!0),T("security-questions"),Z.ZP.success("Password reset instructions sent to your email")}catch(e){Z.ZP.error("Failed to send password reset email")}finally{M(!1)}},$=[{value:"candidate",label:"Candidate",icon:(0,i.jsx)(m.Z,{className:"w-5 h-5"})},{value:"company",label:"Company",icon:(0,i.jsx)(u.Z,{className:"w-5 h-5"})},{value:"admin",label:"Administrator",icon:(0,i.jsx)(x.Z,{className:"w-5 h-5"})}],ee=[{value:"sms",label:"SMS",icon:(0,i.jsx)(h.Z,{className:"w-5 h-5"}),description:"Send code to your mobile number"},{value:"email",label:"Email",icon:(0,i.jsx)(p.Z,{className:"w-5 h-5"}),description:"Send code to your email address"},{value:"app",label:"Authenticator App",icon:(0,i.jsx)(g.Z,{className:"w-5 h-5"}),description:"Use your authenticator app"}];return(0,i.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,i.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)("div",{className:"w-12 h-12 bg-primary rounded-xl flex items-center justify-center shadow-lg",children:(0,i.jsx)("span",{className:"text-white font-bold text-xl",children:"BI"})})}),(0,i.jsxs)("div",{className:"mt-6 text-center",children:[(0,i.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"login"===e?"Welcome back!":"Secure Authentication"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"login"===e?(0,i.jsxs)(i.Fragment,{children:["Don't have an account?"," ",(0,i.jsx)(n(),{href:"/signup",className:"font-medium text-primary hover:text-blue-700",children:"Sign up here"})]}):"Complete verification to access your account"})]})]}),(0,i.jsxs)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[(0,i.jsx)("div",{className:"bg-white py-8 px-4 shadow-xl sm:rounded-xl sm:px-10 border border-gray-200",children:(0,i.jsxs)(C.M,{mode:"wait",children:["login"===e&&(0,i.jsx)(k.E.div,{children:(0,i.jsxs)(k.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,i.jsx)("div",{className:"space-y-3",children:(0,i.jsxs)("button",{type:"button",onClick:X,disabled:E,className:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors",children:[(0,i.jsx)("img",{src:"https://www.google.com/favicon.ico",alt:"Google",className:"w-5 h-5 mr-3"}),"Continue with Google"]})}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,i.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,i.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,i.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with email"})})]}),(0,i.jsxs)("form",{className:"space-y-6",onSubmit:W,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"I am a"}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-3",children:$.map(e=>(0,i.jsxs)("label",{className:"relative flex flex-col items-center p-3 border rounded-lg cursor-pointer transition-all duration-200 ".concat(a.role===e.value?"border-primary bg-primary/5 ring-2 ring-primary/20":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"),children:[(0,i.jsx)("input",{type:"radio",name:"role",value:e.value,checked:a.role===e.value,onChange:Q,className:"sr-only"}),e.icon,(0,i.jsx)("span",{className:"mt-1 text-xs font-medium text-gray-700",children:e.label})]},e.value))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,i.jsx)("div",{className:"mt-1",children:(0,i.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:a.email,onChange:Q,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent sm:text-sm transition-all",placeholder:"Enter your email"})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,i.jsxs)("div",{className:"mt-1 relative",children:[(0,i.jsx)("input",{id:"password",name:"password",type:P?"text":"password",autoComplete:"current-password",required:!0,value:a.password,onChange:Q,className:"appearance-none block w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent sm:text-sm transition-all",placeholder:"Enter your password"}),(0,i.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>S(!P),children:P?(0,i.jsx)(y.Z,{className:"h-5 w-5 text-gray-400"}):(0,i.jsx)(f.Z,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"}),(0,i.jsx)("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),(0,i.jsx)("div",{className:"text-sm",children:(0,i.jsx)("button",{type:"button",className:"font-medium text-primary hover:text-blue-700",onClick:Y,children:"Forgot password?"})})]}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{type:"submit",disabled:E,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:E?(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Signing in..."]}):"Sign in"})})]})]})},"login"),"mfa"===e&&(0,i.jsx)(k.E.div,{children:(0,i.jsxs)(k.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[(0,i.jsxs)("button",{onClick:()=>s("login"),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[(0,i.jsx)(b.Z,{className:"w-4 h-4 mr-1"}),"Back to login"]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(j.Z,{className:"mx-auto h-12 w-12 text-primary"}),(0,i.jsx)("h3",{className:"mt-4 text-lg font-semibold text-gray-900",children:"Two-Factor Authentication"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Choose your preferred verification method"})]}),(0,i.jsx)("div",{className:"space-y-3",children:ee.map(e=>(0,i.jsxs)("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer transition-all ".concat(_.otpMethod===e.value?"border-primary bg-primary/5 ring-2 ring-primary/20":"border-gray-300 hover:border-gray-400"),children:[(0,i.jsx)("input",{type:"radio",name:"otpMethod",value:e.value,checked:_.otpMethod===e.value,onChange:e=>F((0,r._)((0,t._)({},_),{otpMethod:e.target.value})),className:"sr-only"}),e.icon,(0,i.jsxs)("div",{className:"ml-3",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.label}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})]},e.value))}),(0,i.jsx)("div",{className:"border-t pt-4",children:(0,i.jsxs)("button",{onClick:J,disabled:E,className:"w-full flex items-center justify-center p-4 border border-dashed border-gray-300 rounded-lg hover:border-gray-400 transition-colors",children:[(0,i.jsx)(v.Z,{className:"w-6 h-6 text-gray-500 mr-3"}),(0,i.jsxs)("div",{className:"text-left",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Biometric Authentication"}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:"Use fingerprint or face recognition"})]})]})}),A>0&&(0,i.jsxs)(k.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Verification Code"}),(0,i.jsx)("input",{type:"text",value:_.otp,onChange:e=>F((0,r._)((0,t._)({},_),{otp:e.target.value.replace(/\D/g,"").slice(0,6)})),placeholder:"Enter 6-digit code",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg text-center text-lg tracking-widest focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",maxLength:6})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,i.jsx)(N.Z,{className:"w-4 h-4 mr-1"}),Math.floor(A/60),":",(A%60).toString().padStart(2,"0")]}),B&&(0,i.jsx)("button",{onClick:z,className:"text-primary hover:text-blue-700 font-medium",children:"Resend code"})]}),(0,i.jsx)("button",{onClick:H,disabled:E||6!==_.otp.length,className:"w-full py-2 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:E?"Verifying...":"Verify Code"})]}),0===A&&(0,i.jsx)("button",{onClick:z,disabled:E,className:"w-full py-2 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:E?"Sending...":"Send code via ".concat(_.otpMethod.toUpperCase())})]})},"mfa")]})}),(0,i.jsx)("div",{className:"mt-6 text-center",children:(0,i.jsxs)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,i.jsx)(w.Z,{className:"w-3 h-3 mr-1"}),"256-bit SSL encryption"]})})]})]})}}}]);